# Notebooks

This directory contains Jupyter notebooks and supporting files for data
processing and modeling tasks using Amazon EMR with SageMaker Studio Classic and
managing ML lifecycles with MLflow and Amazon SageMaker.

## Directory Structure

```
notebooks/
├── README.md
├── data-wrangling.ipynb
├── modeling.ipynb
└── source_dir
    ├── requirements.txt
    ├── setup.py
    └── train.py
```

## Notebooks and Resources

### Data Wrangling with Amazon EMR and SageMaker Studio Classic

- **Notebook**: `data-wrangling.ipynb`
- **Description**: This notebook demonstrates how to process a large dataset
  using PySpark within SageMaker's SparkMagic kernel with Python 3.7.
- **Setup Guide**: To configure Amazon EMR to work with SageMaker Studio, refer
  to the AWS documentation: [Prepare data using Amazon
  EMR](https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-emr-cluster.html).
  For a hands-on approach, explore the [SageMaker Studio integration with EMR
  Workshop](https://catalog.workshops.aws/sagemaker-studio-emr/en-US/01-interacting-emr-cluster/).
- **Dataset**: Uses the "Malware Detection in Network Traffic Data" dataset
  available on
  [Kaggle](https://www.kaggle.com/datasets/agungpambudi/network-malware-detection-connection-analysis).
  - **Dataset Credit**: Stratosphere Laboratory. A labeled dataset with
  malicious and benign IoT network traffic. January 22th. Agustin Parmisano,
  Sebastian Garcia, Maria Jose Erquiaga.
  [https://www.stratosphereips.org/datasets-iot23](https://www.stratosphereips.org/datasets-iot23).
- **EMR Configuration**: If Amazon EMR templates are not pre-configured, set
  them up using the AWS CloudFormation stack YAML
  `CFN-SagemakerEMRNoAuthProductWithStudio-v4.yaml` from
  [GitHub](https://github.com/aws-samples/sagemaker-studio-emr.git).
  Configuration instructions can be found in the guide: [Configure Amazon EMR
  templates in AWS Service
  Catalog](https://docs.aws.amazon.com/sagemaker/latest/dg/studio-notebooks-set-up-emr-templates.html).

### Modeling with MLflow and Amazon SageMaker

- **Notebook**: `modeling.ipynb`
- **Description**: This notebook details the implementation of machine learning
  lifecycle management using MLflow integrated with Amazon SageMaker.
- **Reference**: The primary methodology is based on the AWS blog post:
  [Managing your machine learning lifecycle with MLflow and Amazon
  SageMaker](https://aws.amazon.com/blogs/machine-learning/managing-your-machine-learning-lifecycle-with-mlflow-and-amazon-sagemaker/).
  For further details and examples, visit the [GitHub
  repository](https://github.com/aws-samples/amazon-sagemaker-mlflow-fargate.git).

#### Supporting Files in `source_dir`

- **`requirements.txt`**: Lists the Python packages required for the
  `modeling.ipynb` notebook to run.
- **`setup.py`**: Setup script for installing the package defined in this
  directory.
- **`train.py`**: Python script used by the `modeling.ipynb` notebook for
  training machine learning models.